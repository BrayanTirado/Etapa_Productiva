<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard Coordinador</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen">

  <!-- Header -->
  <header class="bg-white shadow p-4 flex justify-between items-center">
    <h1 class="text-2xl font-bold text-gray-800">Dashboard Coordinador</h1>

    <div class="flex items-center gap-4">
      <!-- Campana de notificaciones -->
      <a href="{{ url_for('coordinador_bp.notificaciones') }}" class="relative">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-gray-700 hover:text-gray-900" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14V11a6 6 0 00-5-5.917V4a1 1 0 10-2 0v1.083A6 6 0 006 11v3c0 .386-.146.735-.405 1.005L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
        </svg>
        {% if notificaciones_no_leidas > 0 %}
          <span class="absolute -top-1 -right-1 bg-red-500 text-white rounded-full px-2 text-xs font-bold">
            {{ notificaciones_no_leidas }}
          </span>
        {% endif %}
      </a>

      <!-- Logout -->
      <a href="{{ url_for('coordinador_bp.logout') }}" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded">
        Cerrar sesión
      </a>
    </div>
  </header>

  <!-- Main -->
  <main class="p-6 space-y-6">

    <!-- Sección: Instructores -->
    <section class="bg-white p-6 rounded-lg shadow">
      <h2 class="text-xl font-semibold mb-4">Instructores</h2>
      {% if instructores %}
        <ul class="list-disc list-inside space-y-1">
          {% for instructor in instructores %}
            <li>{{ instructor.nombre_instructor }} {{ instructor.apellido_instructor }}</li>
          {% endfor %}
        </ul>
      {% else %}
        <p>No hay instructores registrados.</p>
      {% endif %}
      <a href="{{ url_for('coordinador_bp.generar_token') }}"
         class="mt-4 inline-block bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded">
        Generar token para instructores
      </a>
    </section>

    <!-- Sección: Aprendices -->
    <section class="bg-white p-6 rounded-lg shadow">
      <h2 class="text-xl font-semibold mb-4">Aprendices</h2>
      {% if aprendices %}
        <ul class="list-disc list-inside space-y-1">
          {% for aprendiz in aprendices %}
            <li>{{ aprendiz.nombre }} {{ aprendiz.apellido }}</li>
          {% endfor %}
        </ul>
      {% else %}
        <p>No hay aprendices asignados.</p>
      {% endif %}
      <a href="{{ url_for('coordinador_bp.asignar_aprendiz') }}"
         class="mt-4 inline-block bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded">
        Asignar aprendices a instructores
      </a>
    </section>

    <!-- Sección: Enviar Mensaje / Nota -->
    <section class="bg-white p-6 rounded-lg shadow">
      <h2 class="text-xl font-semibold mb-4">Enviar Mensaje / Nota</h2>

      <form method="POST" action="{{ url_for('coordinador_bp.enviar_mensaje') }}" class="space-y-4">
        <!-- Seleccionar rol destinatario -->
        <div>
          <label for="rol_destinatario" class="block text-gray-700 font-medium">Seleccionar rol destinatario:</label>
          <select name="rol_destinatario" id="rol_destinatario" required
                  class="mt-1 block w-full border-gray-300 rounded px-3 py-2">
            <option value="">-- Selecciona un rol --</option>
            <option value="Administrador">Administrador</option>
            <option value="Instructor">Instructor</option>
            <option value="Aprendiz">Aprendiz</option>
          </select>
        </div>

        <!-- Motivo -->
        <div>
          <label for="motivo" class="block text-gray-700 font-medium">Motivo:</label>
          <input type="text" name="motivo" id="motivo" placeholder="Motivo del mensaje" required
                 class="mt-1 block w-full border-gray-300 rounded px-3 py-2">
        </div>

        <!-- Mensaje -->
        <div>
          <label for="mensaje" class="block text-gray-700 font-medium">Mensaje:</label>
          <textarea name="mensaje" id="mensaje" rows="4" placeholder="Escribe tu mensaje..." required
                    class="mt-1 block w-full border-gray-300 rounded px-3 py-2"></textarea>
        </div>

        <button type="submit"
                class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded">
          Enviar Mensaje
        </button>
      </form>

    </section>

    <!-- Sección: Notificaciones -->
    <section class="bg-white p-6 rounded-lg shadow">
      <h2 class="text-xl font-semibold mb-4">Notificaciones</h2>

      {% if notificaciones %}
        <ul class="space-y-2">
          {% for noti in notificaciones %}
            <li class="p-4 rounded-lg border {% if not noti.visto %}bg-blue-100{% else %}bg-gray-100{% endif %} flex justify-between items-center">
              <span>{{ noti.mensaje[:50] ~ ('...' if noti.mensaje|length > 50 else '') }}</span>
              <a href="{{ url_for('coordinador_bp.ver_notificacion', noti_id=noti.id) }}">Ver</a>
      

            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p class="text-gray-600">No hay notificaciones.</p>
      {% endif %}
    </section>

    <a href="{{ url_for('coordinador_bp.crear_sede') }}"
   class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded">
   Registrar Sede
</a>

  </main>
</body>
</html>
